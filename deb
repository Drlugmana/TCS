private async Task<List<DBProblem>> MapToDBProblems(List<DynatraceProblem> problems, APIToken token)
{
    // 1) Calcular títulos únicos y precargar predicciones en caché (usar Title)
    var uniqueDescriptions = problems
        .Select(p => p?.Title)
        .Where(s => !string.IsNullOrWhiteSpace(s))
        .Distinct()
        .ToList();

    await PredictionCache.UpdateOrStorePredictionsAsync(uniqueDescriptions, _predictor);

    // 2) Mapear a DBProblem
    var dbProblems = new List<DBProblem>();

    foreach (var problem in problems)
    {
        if (problem == null) continue;

        var impacted   = problem.ImpactedEntities ?? new List<ProblemEntity>();
        var evidence   = problem.EvidenceDetails ?? new EvidenceDetails();
        var affectedCI = await _serverMatcher.FindAffectedServersAsync(impacted, evidence);

        // Usamos Title como shortDescription
        var shortDescription = problem.Title ?? string.Empty;

        string jurisdiction = "Unknown";
        if (!string.IsNullOrWhiteSpace(shortDescription) &&
            PredictionCache.TryGetPrediction(shortDescription, out bool isTcs, out float probability))
        {
            jurisdiction = isTcs ? "TCS" : "NO TCS";
        }

        dbProblems.Add(new DBProblem(problem, token.Environment, token.Tenant,
                                     shortDescription, affectedCI, jurisdiction));
    }

    return dbProblems;
}