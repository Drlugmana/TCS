    row++;
}   // <--- ←← fin del foreach que llena "Monitoreados"

// === DEDUPE EN HOJA "Monitoreados" POR SERVER NAME (columna 1) ===
int lastRow = row - 1;
var seen = new HashSet<string>(StringComparer.OrdinalIgnoreCase);

for (int r = 2; r <= lastRow; )
{
    var name = worksheet.Cells[r, 1].Value?.ToString() ?? string.Empty;
    var key  = name.Trim(); // normaliza: quita espacios y compara sin mayúsculas/minúsculas

    if (!seen.Add(key))
    {
        worksheet.DeleteRow(r, 1, true); // borra la fila duplicada y desplaza hacia arriba
        lastRow--;                       // ajusta el límite porque la hoja se encogió
        continue;                        // NO incrementes r: ahora en r está la siguiente fila
    }

    r++; // avanza solo cuando no hubo borrado
}
// === FIN DEDUPE ===